language: c

env:
  global:
    - TARGET_DIR=bin
    - secure: ryN8BYRWLf7IhrW5665eoPaXXHZM8XA75vm9WERwWUKuLz775oIdlHnfjXO0MFZCQ1qiTuw4uED1lwMzqpLAmuGQgEy7j1X8NYmY21CziXBSy3MYdVxx2xkkUwQlswcqA2MRNoM3CNSmDuT3g/yo1HfmjCa0NpjG4obW9pC8Bwo=
    - secure: R8e8OcFNtYhbbAO554yL9j4980aVsWYNy+i+6vP5IW8aiv5mIGh6FSCAtM9IlY1JAhrRkVVGDsUBX5XaaIXXmJVBaEQ2gDwN6vBG+RHLfLX7JtVJXezMmDiE0fK5o6EVn+Jr76FCzSLp4hkTZl7VOLvMpXGo6A9MCatfio+18Zc=
  matrix:
    - TARGET=cpp
    - TARGET=cs
    - TARGET=flash
    - TARGET=java
    - TARGET=js TOOLCHAIN="browser"
    - TARGET=js TOOLCHAIN="nodejs"
    - TARGET=neko
    - TARGET=php
    - TARGET=python

matrix:
  fast_finish: true

before_install: # clone travis-hx repo
  - travis_retry git clone --depth=50 --branch=master git://github.com/waneck/travis-hx.git ~/travis-hx

install: # setup the target
  - ~/travis-hx/setup.sh

script:
  - cd $TRAVIS_BUILD_DIR
  - haxe hxml/$TARGET.hxml -D travis
  # run the tests
  - ~/travis-hx/runtests.sh $FILENAME # this will set the $FILENAME defined on the environment variable to run the tests
